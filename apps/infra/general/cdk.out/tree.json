{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.230.0"},"children":{"CrawlerStack-dev":{"id":"CrawlerStack-dev","path":"CrawlerStack-dev","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.230.0"},"children":{"CrawlerDLQ":{"id":"CrawlerDLQ","path":"CrawlerStack-dev/CrawlerDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"crawler-dlq-dev"}}}}},"CrawlerCommandQueue":{"id":"CrawlerCommandQueue","path":"CrawlerStack-dev/CrawlerCommandQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerCommandQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":345600,"queueName":"crawler-commands-dev","receiveMessageWaitTimeSeconds":20,"redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["CrawlerDLQA3F51DBC","Arn"]},"maxReceiveCount":3},"visibilityTimeout":900}}}}},"CrawlerResultsTopic":{"id":"CrawlerResultsTopic","path":"CrawlerStack-dev/CrawlerResultsTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerResultsTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Crawler Results Notifications","topicName":"crawler-results-dev"}}}}},"CrawlerFunction":{"id":"CrawlerFunction","path":"CrawlerStack-dev/CrawlerFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.DockerImageFunction","version":"2.230.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CrawlerStack-dev/CrawlerFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.230.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CrawlerStack-dev/CrawlerFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}},"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CrawlerStack-dev/CrawlerFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":"*"},{"Action":["sqs:ReceiveMessage","sqs:ChangeMessageVisibility","sqs:GetQueueUrl","sqs:DeleteMessage","sqs:GetQueueAttributes"],"Effect":"Allow","Resource":{"Fn::GetAtt":["CrawlerCommandQueue9C41D89B","Arn"]}},{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"CrawlerResultsTopicA77CD6BF"}}],"Version":"2012-10-17"},"policyName":"CrawlerFunctionServiceRoleDefaultPolicyB8AD36D9","roles":[{"Ref":"CrawlerFunctionServiceRoleD519478C"}]}}}}}}},"AssetImage":{"id":"AssetImage","path":"CrawlerStack-dev/CrawlerFunction/AssetImage","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr_assets.DockerImageAsset","version":"2.230.0"},"children":{"Staging":{"id":"Staging","path":"CrawlerStack-dev/CrawlerFunction/AssetImage/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.230.0"}},"Repository":{"id":"Repository","path":"CrawlerStack-dev/CrawlerFunction/AssetImage/Repository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.230.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["x86_64"],"code":{"imageUri":{"Fn::Sub":"503411876186.dkr.ecr.ca-central-1.${AWS::URLSuffix}/cdk-hnb659fds-container-assets-503411876186-ca-central-1:2a24e124db75df44cf731613bc1e27397e6495b3169da4f2679ce237ebc81ac7"}},"description":"Web crawler and data extractor using Puppeteer","environment":{"variables":{"NODE_ENV":"dev","SQS_QUEUE_URL":{"Ref":"CrawlerCommandQueue9C41D89B"},"SNS_TOPIC_ARN":{"Ref":"CrawlerResultsTopicA77CD6BF"}}},"functionName":"crawler-dataextractor-dev","memorySize":2048,"packageType":"Image","role":{"Fn::GetAtt":["CrawlerFunctionServiceRoleD519478C","Arn"]},"timeout":900}}},"LogRetention":{"id":"LogRetention","path":"CrawlerStack-dev/CrawlerFunction/LogRetention","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogRetention","version":"2.230.0"},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerFunction/LogRetention/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"LogGroup":{"id":"LogGroup","path":"CrawlerStack-dev/CrawlerFunction/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}},"SqsEventSource:CrawlerStackdevCrawlerCommandQueue44B09667":{"id":"SqsEventSource:CrawlerStackdevCrawlerCommandQueue44B09667","path":"CrawlerStack-dev/CrawlerFunction/SqsEventSource:CrawlerStackdevCrawlerCommandQueue44B09667","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerFunction/SqsEventSource:CrawlerStackdevCrawlerCommandQueue44B09667/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":1,"eventSourceArn":{"Fn::GetAtt":["CrawlerCommandQueue9C41D89B","Arn"]},"functionName":{"Ref":"CrawlerFunction614391C2"},"functionResponseTypes":["ReportBatchItemFailures"],"maximumBatchingWindowInSeconds":0}}}}}}},"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a":{"id":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Code":{"id":"Code","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.230.0"},"children":{"Stage":{"id":"Stage","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.230.0"}},"AssetBucket":{"id":"AssetBucket","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.230.0","metadata":[]}}}},"ServiceRole":{"id":"ServiceRole","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.230.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}},"Resource":{"id":"Resource","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:PutRetentionPolicy","logs:DeleteRetentionPolicy"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB","roles":[{"Ref":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"}]}}}}}}},"Resource":{"id":"Resource","path":"CrawlerStack-dev/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"CrawlerTriggerRule":{"id":"CrawlerTriggerRule","path":"CrawlerStack-dev/CrawlerTriggerRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CrawlerStack-dev/CrawlerTriggerRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Triggers the crawler Lambda function","eventPattern":{"source":["custom.crawler"],"detail-type":["CrawlRequest"]},"name":"crawler-trigger-dev","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["CrawlerFunction614391C2","Arn"]},"retryPolicy":{"maximumRetryAttempts":2}}]}}},"AllowEventRuleCrawlerStackdevCrawlerFunctionD022F367":{"id":"AllowEventRuleCrawlerStackdevCrawlerFunctionD022F367","path":"CrawlerStack-dev/CrawlerTriggerRule/AllowEventRuleCrawlerStackdevCrawlerFunctionD022F367","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["CrawlerFunction614391C2","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["CrawlerTriggerRule0B25D901","Arn"]}}}}}},"CrawlerFunctionName":{"id":"CrawlerFunctionName","path":"CrawlerStack-dev/CrawlerFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CrawlerFunctionArn":{"id":"CrawlerFunctionArn","path":"CrawlerStack-dev/CrawlerFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"EventBridgeRuleName":{"id":"EventBridgeRuleName","path":"CrawlerStack-dev/EventBridgeRuleName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CommandQueueUrl":{"id":"CommandQueueUrl","path":"CrawlerStack-dev/CommandQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CommandQueueArn":{"id":"CommandQueueArn","path":"CrawlerStack-dev/CommandQueueArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"DeadLetterQueueUrl":{"id":"DeadLetterQueueUrl","path":"CrawlerStack-dev/DeadLetterQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"ResultsTopicArn":{"id":"ResultsTopicArn","path":"CrawlerStack-dev/ResultsTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CrawlerStack-dev/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"CrawlerStack-dev/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CrawlerStack-dev/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.230.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CrawlerStack-dev/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.230.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}}}}}